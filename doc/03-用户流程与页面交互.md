# EduNexus AI 用户流程与页面交互规范

## 1. 文档目标
本文件定义前端页面结构、关键交互流程、状态反馈和异常分支，用于确保产品逻辑在 UI 层准确落地。

## 2. 信息架构与路由

## 2.1 公共路由

- `/login` 登录页
- `/register` 注册页
- `/403` 无权限页
- `/404` 未找到页

## 2.2 学生端路由（STUDENT）

- `/student/chat` 智能问答（左侧会话列表 + 右侧消息区）
- `/student/exercise` 练习做题
- `/student/exercise/records` 做题记录
- `/student/wrong-book` 错题本
- `/student/ai-questions` AI 个性化出题
- `/student/profile` 个人信息

## 2.3 教师端路由（TEACHER）

- `/teacher/knowledge` 知识库文档管理
- `/teacher/plans` 教案管理
- `/teacher/analytics` 学情分析
- `/teacher/suggestions` 学生建议管理

## 2.4 管理端路由（ADMIN）

- `/admin/users` 用户管理
- `/admin/resources` 资源管理
- `/admin/dashboard` 指标看板
- `/admin/audits` 操作日志

## 3. 全局交互规范

1. 页面必须提供四种状态：`loading`、`empty`、`error`、`ready`。
2. 写操作按钮（提交/删除/生成）执行期间必须禁用并显示进度。
3. 所有错误提示需可读，不可只显示“请求失败”。
4. 涉及删除操作必须二次确认。
5. 页面刷新后应可恢复核心上下文（当前会话、筛选条件、分页状态）。

## 4. 学生端流程

## 4.1 智能问答流程（R-CHAT-01~09）

### 4.1.1 首次进入

1. 页面加载调用 `GET /student/chat/sessions`。
2. 若无会话，右侧显示引导文案和“新建会话”按钮。

### 4.1.2 新建会话

1. 点击“新建会话”调用 `POST /student/chat/session`。
2. 成功后选中新会话，右侧消息区置空。
3. 标题初始显示“新建对话”。

### 4.1.3 发送消息

1. 输入问题并点击发送，立即在消息区插入用户消息（乐观更新）。
2. 调用 `POST /student/chat/session/{sessionId}/message`。
3. AI 回复可采用流式渲染（推荐）或整包返回（兜底）。
4. 回复下方展示引用来源（文档名、相似度/片段）。

### 4.1.4 会话详情与删除

1. 点击左侧会话项，调用 `GET /student/chat/session/{sessionId}`。
2. 点击删除时，二次确认后调用 `DELETE /student/chat/session/{sessionId}`。
3. 删除成功后从列表移除并自动选中下一会话。

### 4.1.5 异常分支

- 403：提示“无权访问该会话”。
- 429/503：提示“AI 服务繁忙，请稍后重试”。
- 空引用：提示“当前回答未命中知识库，建议补充资料”。

## 4.2 练习做题流程（R-EX-01~10）

### 4.2.1 获取题目

1. 页面默认调用 `GET /student/exercise/questions`。
2. 筛选器支持学科、难度、分页。

### 4.2.2 提交答案

1. 学生完成作答后点击“提交”。
2. 调用 `POST /student/exercise/submit`。
3. 结果页显示：总分、正确题数、逐题对错、标准答案。

### 4.2.3 查看解析

1. 从结果页点击“查看解析”。
2. 调用 `GET /student/exercise/{recordId}/analysis`。
3. 若存在教师建议，解析页突出展示建议内容。

### 4.2.4 错题与历史

1. 错题页调用 `GET /student/exercise/wrong-questions`。
2. 点击“移除错题”调用 `DELETE /student/exercise/wrong-questions/{questionId}`。
3. 历史页调用 `GET /student/exercise/records`，支持时间区间筛选。

## 4.3 AI 个性化出题流程（R-AIQ-01~08）

1. 学生输入生成参数（学科、难度、数量、知识点）。
2. 调用 `POST /student/ai-questions/generate`。
3. 成功后进入“即时答题”模式。
4. 提交调用 `POST /student/ai-questions/submit`，结果页显示得分与对错。
5. 解析调用 `GET /student/ai-questions/{recordId}/analysis`。
6. 历史页调用 `GET /student/ai-questions`，显示完成状态与正确率。

## 5. 教师端流程

## 5.1 知识库管理（R-TCH-01~04）

1. 上传区选择 PDF/Docx，调用 `POST /teacher/knowledge/documents`。
2. 列表轮询 `GET /teacher/knowledge/documents` 展示状态：UPLOADING/PARSING/EMBEDDING/READY/FAILED。
3. 失败项可查看错误信息并重新上传。
4. 删除文档调用 `DELETE /teacher/knowledge/documents/{documentId}`。

## 5.2 教案管理（R-TCH-05~06）

1. 填写主题、年级、课时后调用 `POST /teacher/plans/generate`。
2. 生成后可在编辑器中修改并保存（`PUT /teacher/plans/{planId}`）。
3. 列表页通过 `GET /teacher/plans` 展示历史教案。
4. 导出通过 `GET /teacher/plans/{planId}/export?format=md|pdf`。
5. 分享通过 `POST /teacher/plans/{planId}/share` 生成分享链接。

## 5.3 学情与建议（R-TCH-07~08）

1. 学情页调用 `GET /teacher/students/{studentId}/analytics`。
2. 建议页创建建议调用 `POST /teacher/suggestions`。
3. 建议提交后，学生解析页和 AI 出题上下文应可见该建议。

## 6. 管理端流程

## 6.1 用户管理（R-ADM-01）

1. 列表：`GET /admin/users`。
2. 新增：`POST /admin/users`。
3. 角色/状态更新：`PATCH /admin/users/{userId}`。

## 6.2 资源与看板（R-ADM-02~04）

1. 操作日志：`GET /admin/audits`。
2. 资源列表：`GET /admin/resources`。
3. 资源下载：`GET /admin/resources/{resourceId}/download`。
4. 看板：`GET /admin/dashboard/metrics`。

## 7. 页面级验收要点

1. 页面功能按钮必须和接口能力一一对应，无“展示有按钮但后端无能力”的假交互。
2. 所有列表必须具备空态文案。
3. 所有关键写操作必须可观测（成功提示、失败提示、可重试）。
4. 所有学生数据页面必须通过后端归属校验，不得依赖前端隐藏实现权限。

---
文档状态：`v1.0.0`
